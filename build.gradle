apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'maven'

//project.version = '1.0.0'
project.group = 'de.prob'


repositories {
	mavenCentral()
   	mavenRepo name: 'cobra_ext', urls: "http://cobra.cs.uni-duesseldorf.de/artifactory/repo"
}

dependencies {
    compile (group: 'de.stups', name: 'tla', version: '1.0.1')
	testCompile (group: 'de.prob', name: 'prologlib', version: '2.0.158')
 	testCompile (group: 'de.prob', name: 'parserbase', version: '2.0.158')
  	testCompile (group: 'de.prob', name: 'bparser', version: '2.0.158')
	testCompile group: 'junit', name: 'junit', version: '4.+'
}

task pack(type: Jar, dependsOn: [jar]) {
	baseName = 'TLA2B'
	deps = configurations.runtime + configurations.archives.allArtifactFiles
	depClasses = {
		deps.collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
	from(depClasses) {
		exclude 'META-INF/MANIFEST.MF'
	}
	manifest { attributes 'Main-Class': 'translation.TLA2B' }
	doLast{
		println "Created archive: "+archivePath
	}
}

task copy(type:Copy, dependsOn: pack) {
   from('build/libs/') { include 'TLA2B.jar' }
   into 'build/tla'
   from('src/main/resources/') { include '**/*' }
   into 'build/tla'
}


task deploy(type: Zip, dependsOn: copy) {
   from('build/') { include 'tla/**' }
   baseName = 'tla'
}


